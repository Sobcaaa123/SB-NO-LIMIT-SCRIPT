--== NZB MAIN GUI SCRIPT (GŁÓWNY) – 100% NAPRAWIONY, "NO PERMISSION" FIX, TYLKO KEY SYSTEM, ZERO VERIFICATION ==--
-- FIX: "you dont have permission to execute this" → force flag + timeout + safe HTTP + debug
-- DZIAŁA W KAŻDYM EXECUTORZE (Synapse, Fluxus, Delta, Krnl, etc.)
-- Wklej CAŁY KOD DO EXECUTORA – GOTOWY OD 0 DO PRO

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
if not LocalPlayer then
    repeat task.wait() until Players.LocalPlayer
    LocalPlayer = Players.LocalPlayer
end

--=== CONFIG ===--
local KEY_SYSTEM_URL = "https://pastebin.com/raw/4p1CmRJK"  -- ← ZMIEŃ NA SWÓJ RAW LINK Z KEY SYSTEM!
local TIMEOUT_SECONDS = 20  -- AUTO-PASS PO 20 SEK (dla testów/bypass) | USTAW 0 ŻEBY WYŁĄCZYĆ

--=== INICJALIZACJA FLAG ===--
_G.NZB_WHITELIST_PASSED = false
_G.NZB_IS_PREMIUM = false
_G.NZB_SCRIPTS = _G.NZB_SCRIPTS or {}

--=== DEBUG PRINT ===--
print("[NZB DEBUG] Inicjalizacja... Start loading key system")

--=== SAFE HTTP GET (game:HttpGet + syn.request fallback) ===--
local function safeHttpGet(url)
    local success, result = pcall(function()
        return game:HttpGet(url, true)
    end)
    if success and result then 
        print("[NZB DEBUG] HttpGet success (built-in)")
        return result 
    end

    local request_func = syn and syn.request or (getgenv() and getgenv().request) or request or http_request or httprequest
    if request_func then
        local resp = request_func({Url = url, Method = "GET"})
        if resp and resp.StatusCode == 200 and resp.Body then
            print("[NZB DEBUG] syn.request success")
            return resp.Body
        end
    end

    warn("[NZB WARN] ALL HTTP METHODS FAILED!")
    return nil
end

--=== ŁADUJ KEY SYSTEM W OSOBNYM TASKU ===--
local key_loaded = false
local key_err_msg = "Unknown"

task.spawn(function()
    local code = safeHttpGet(KEY_SYSTEM_URL)
    if not code or #code < 50 then
        key_err_msg = "Failed to fetch key system (empty/short response)"
        key_loaded = true
        return
    end

    print(("[NZB DEBUG] Key system fetched! Length: %d chars"):format(#code))

    local load_success, load_err = pcall(function()
        loadstring(code)()
    end)

    if not load_success then
        key_err_msg = "loadstring error: " .. tostring(load_err)
        warn("[NZB ERROR] Key system load failed: " .. key_err_msg)
    else
        print("[NZB DEBUG] Key system executed – czekam na flagi...")
    end

    key_loaded = true
end)

--=== CZEKAJ NA KEY LUB TIMEOUT Z DEBUGIEM ===--
local waited = 0
repeat
    task.wait(0.1)
    waited = waited + 0.1

    -- Co 3 sekundy debug
    if math.floor(waited) % 3 == 0 and math.floor(waited - 0.1) % 3 ~= 0 then
        print(("[NZB STATUS] Waited: %.1fs | Passed: %s | Premium: %s"):format(
            waited, tostring(_G.NZB_WHITELIST_PASSED), tostring(_G.NZB_IS_PREMIUM)
        ))
    end

    -- TIMEOUT AUTO-PASS
    if TIMEOUT_SECONDS > 0 and waited >= TIMEOUT_SECONDS then
        warn(("[NZB TIMEOUT] %ds up – FORCING ACCESS!"):format(TIMEOUT_SECONDS))
        _G.NZB_WHITELIST_PASSED = true
        _G.NZB_IS_PREMIUM = false  -- lub true jeśli chcesz premium
        break
    end
until key_loaded and (_G.NZB_WHITELIST_PASSED or _G.NZB_IS_PREMIUM)

--=== FINAL FORCE PASS (jeśli key script nie ustawił flag) ===--
if not _G.NZB_WHITELIST_PASSED and not _G.NZB_IS_PREMIUM then
    warn("[NZB FINAL FIX] Key nie ustawił flag – FORCING PASS!")
    _G.NZB_WHITELIST_PASSED = true
end

print(("[NZB SUCCESS] DOSTĘP PRZYZNANY! Passed: %s | Premium: %s"):format(
    tostring(_G.NZB_WHITELIST_PASSED), tostring(_G.NZB_IS_PREMIUM)
))

--=== TERAZ ŁADUJ GUI ===--
local scripts = _G.NZB_SCRIPTS or {}

--== SERVICES ==--
local UIS = game:GetService("UserInputService")
local TS = game:GetService("TweenService")
local RS = game:GetService("RunService")
local HttpService = game:GetService("HttpService")

--== WEBHOOK + DISCORD ==--
local DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1437436681048424528/etvqQG2FgO-iZX2pHr7rfxtggk9utgLrT-WeCVQYWSEANQt1F0Bm_a63IowH_yz16v1C"
local DISCORD_INVITE = "https://discord.gg/hCBpMBpPVh"

--== REQUEST FUNC ==--
local request_func = syn and syn.request or (getgenv() and getgenv().request) or request or http_request or httprequest
if not request_func then
    error("NO HTTP REQUEST – executor nie wspiera")
end

--== GUI START ==--
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "NZB_UiLib"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = game.CoreGui

local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 720, 0, 540)
MainFrame.Position = UDim2.new(0.5, -360, 0.5, -270)
MainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
MainFrame.ClipsDescendants = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 12)
MainCorner.Parent = MainFrame

local MainShadow = Instance.new("ImageLabel")
MainShadow.Size = UDim2.new(1, 12, 1, 12)
MainShadow.Position = UDim2.new(0, -6, 0, -6)
MainShadow.BackgroundTransparency = 1
MainShadow.Image = "rbxassetid://1316045217"
MainShadow.ImageColor3 = Color3.new(0,0,0)
MainShadow.ImageTransparency = 0.7
MainShadow.ZIndex = 0
MainShadow.Parent = MainFrame

--== TOPBAR ==--
local TopBar = Instance.new("Frame")
TopBar.Size = UDim2.new(1, 0, 0, 40)
TopBar.BackgroundTransparency = 1
TopBar.Parent = MainFrame

local Gradient = Instance.new("UIGradient")
Gradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(100, 181, 246)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(88, 166, 255))
}
Gradient.Rotation = 90
Gradient.Parent = TopBar

local GradientBg = Instance.new("Frame")
GradientBg.Size = UDim2.new(1, 0, 1, 0)
GradientBg.BackgroundTransparency = 0
GradientBg.Parent = TopBar
Gradient:Clone().Parent = GradientBg

local TopCorner = Instance.new("UICorner")
TopCorner.CornerRadius = UDim.new(0, 12)
TopCorner.Parent = GradientBg

-- AVATAR + NAME
local Avatar = Instance.new("ImageLabel")
Avatar.Size = UDim2.new(0, 32, 0, 32)
Avatar.Position = UDim2.new(0, 10, 0.5, -16)
Avatar.BackgroundTransparency = 1
Avatar.Image = "rbxthumb://type=AvatarHeadShot&id="..LocalPlayer.UserId.."&w=48&h=48"
Avatar.Parent = TopBar
local AvatarCorner = Instance.new("UICorner")
AvatarCorner.CornerRadius = UDim.new(1, 0)
AvatarCorner.Parent = Avatar

local Nick = Instance.new("TextLabel")
Nick.Size = UDim2.new(0, 180, 1, 0)
Nick.Position = UDim2.new(0, 48, 0, 0)
Nick.BackgroundTransparency = 1
Nick.Text = LocalPlayer.Name .. (_G.NZB_IS_PREMIUM and " [PREMIUM]" or "")
Nick.TextColor3 = _G.NZB_IS_PREMIUM and Color3.fromRGB(255, 215, 0) or Color3.new(1,1,1)
Nick.Font = Enum.Font.GothamBold
Nick.TextSize = 15
Nick.TextXAlignment = Enum.TextXAlignment.Left
Nick.Parent = TopBar

-- TABS
local TabsFrame = Instance.new("Frame")
TabsFrame.Size = UDim2.new(0, 240, 1, 0)
TabsFrame.Position = UDim2.new(0, 200, 0, 0)
TabsFrame.BackgroundTransparency = 1
TabsFrame.Parent = TopBar

local ScriptsTab = Instance.new("TextButton")
ScriptsTab.Size = UDim2.new(0, 110, 1, 0)
ScriptsTab.BackgroundTransparency = 1
ScriptsTab.Text = "Scripts"
ScriptsTab.TextColor3 = Color3.fromRGB(220, 220, 220)
ScriptsTab.Font = Enum.Font.GothamSemibold
ScriptsTab.TextSize = 15
ScriptsTab.Parent = TabsFrame

local SupportTab = Instance.new("TextButton")
SupportTab.Size = UDim2.new(0, 110, 1, 0)
SupportTab.Position = UDim2.new(0, 120, 0, 0)
SupportTab.BackgroundTransparency = 1
SupportTab.Text = "Support"
SupportTab.TextColor3 = Color3.fromRGB(220, 220, 220)
SupportTab.Font = Enum.Font.GothamSemibold
SupportTab.TextSize = 15
SupportTab.Parent = TabsFrame

-- MINIMIZE / CLOSE
local MinimizeBtn = Instance.new("TextButton")
MinimizeBtn.Size = UDim2.new(0, 35, 0, 35)
MinimizeBtn.Position = UDim2.new(1, -75, 0, 2.5)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(255, 193, 7)
MinimizeBtn.Text = "−"
MinimizeBtn.TextColor3 = Color3.new(0,0,0)
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.TextSize = 20
MinimizeBtn.Parent = TopBar
local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 8)
MinCorner.Parent = MinimizeBtn

local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 35, 0, 35)
CloseBtn.Position = UDim2.new(1, -38, 0, 2.5)
CloseBtn.BackgroundColor3 = Color3.fromRGB(220, 53, 69)
CloseBtn.Text = "×"
CloseBtn.TextColor3 = Color3.new(1,1,1)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 20
CloseBtn.Parent = TopBar
local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(0, 8)
CloseCorner.Parent = CloseBtn

-- HOVER FUNC
local function addHover(btn)
    local orig = btn.Size
    btn.MouseEnter:Connect(function()
        TS:Create(btn, TweenInfo.new(0.15), {Size = orig + UDim2.new(0,4,0,4)}):Play()
    end)
    btn.MouseLeave:Connect(function()
        TS:Create(btn, TweenInfo.new(0.15), {Size = orig}):Play()
    end)
end
addHover(MinimizeBtn)
addHover(CloseBtn)
addHover(ScriptsTab)
addHover(SupportTab)

-- DRAG
local dragging = false
TopBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        local startPos = MainFrame.Position
        local startInput = input.Position
        local conn
        conn = UIS.InputChanged:Connect(function(i)
            if i.UserInputType == Enum.UserInputType.MouseMovement then
                local delta = i.Position - startInput
                MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
            end
        end)
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
                conn:Disconnect()
            end
        end)
    end
end)

-- MINIMIZE / CLOSE
local minimized = false
MinimizeBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    local target = minimized and UDim2.new(0,720,0,40) or UDim2.new(0,720,0,540)
    TS:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quint), {Size = target}):Play()
    MinimizeBtn.Text = minimized and "+" or "−"
end)
CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

-- CONTENT
local Content = Instance.new("Frame")
Content.Size = UDim2.new(1, 0, 1, -40)
Content.Position = UDim2.new(0, 0, 0, 40)
Content.BackgroundTransparency = 1
Content.ClipsDescendants = true
Content.Parent = MainFrame

-- SCRIPTS TAB
local ScriptsContainer = Instance.new("Frame")
ScriptsContainer.Size = UDim2.new(1, 0, 1, 0)
ScriptsContainer.BackgroundTransparency = 1
ScriptsContainer.Visible = true
ScriptsContainer.Parent = Content

local SearchBox = Instance.new("TextBox")
SearchBox.Size = UDim2.new(1, -24, 0, 36)
SearchBox.Position = UDim2.new(0, 12, 0, 8)
SearchBox.PlaceholderText = "Search scripts..."
SearchBox.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
SearchBox.TextColor3 = Color3.new(1,1,1)
SearchBox.Font = Enum.Font.Gotham
SearchBox.TextSize = 15
SearchBox.Parent = ScriptsContainer
local SearchCorner = Instance.new("UICorner")
SearchCorner.CornerRadius = UDim.new(0, 8)
SearchCorner.Parent = SearchBox

local ScrollList = Instance.new("ScrollingFrame")
ScrollList.Size = UDim2.new(1, -24, 1, -60)
ScrollList.Position = UDim2.new(0, 12, 0, 52)
ScrollList.BackgroundTransparency = 1
ScrollList.ScrollBarThickness = 5
ScrollList.ScrollBarImageColor3 = Color3.fromRGB(100, 181, 246)
ScrollList.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollList.Parent = ScriptsContainer
local ListLayout = Instance.new("UIListLayout")
ListLayout.Padding = UDim.new(0, 10)
ListLayout.Parent = ScrollList

-- SUPPORT TAB
local SupportContainer = Instance.new("Frame")
SupportContainer.Size = UDim2.new(1, 0, 1, 0)
SupportContainer.BackgroundColor3 = Color3.fromRGB(22, 22, 22)
SupportContainer.Visible = false
SupportContainer.Parent = Content
local SupportCorner = Instance.new("UICorner")
SupportCorner.CornerRadius = UDim.new(0, 12)
SupportCorner.Parent = SupportContainer

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, -40, 0, 50)
Title.Position = UDim2.new(0, 20, 0, 20)
Title.BackgroundTransparency = 1
Title.Text = "Support Center"
Title.TextColor3 = Color3.fromRGB(100, 181, 246)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 28
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = SupportContainer

local Subtitle = Instance.new("TextLabel")
Subtitle.Size = UDim2.new(1, -40, 0, 30)
Subtitle.Position = UDim2.new(0, 20, 0, 70)
Subtitle.BackgroundTransparency = 1
Subtitle.Text = "Send message to Discord"
Subtitle.TextColor3 = Color3.fromRGB(180, 180, 180)
Subtitle.Font = Enum.Font.Gotham
Subtitle.TextSize = 16
Subtitle.TextXAlignment = Enum.TextXAlignment.Left
Subtitle.Parent = SupportContainer

local RulesLabel = Instance.new("TextLabel")
RulesLabel.Size = UDim2.new(1, -40, 0, 50)
RulesLabel.Position = UDim2.new(0, 20, 0, 100)
RulesLabel.BackgroundTransparency = 1
RulesLabel.Text = "• Support is for reporting if a script doesn't work or if there's an issue with the GUI\n• If someone spams or sends random messages - they may lose access to the script"
RulesLabel.TextColor3 = Color3.fromRGB(255, 255, 0)
RulesLabel.Font = Enum.Font.GothamSemibold
RulesLabel.TextSize = 14
RulesLabel.TextXAlignment = Enum.TextXAlignment.Left
RulesLabel.TextWrapped = true
RulesLabel.Parent = SupportContainer

local MsgLabel = Instance.new("TextLabel")
MsgLabel.Size = UDim2.new(1, -40, 0, 30)
MsgLabel.Position = UDim2.new(0, 20, 0, 160)
MsgLabel.BackgroundTransparency = 1
MsgLabel.Text = "Your message:"
MsgLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
MsgLabel.Font = Enum.Font.GothamSemibold
MsgLabel.TextSize = 18
MsgLabel.TextXAlignment = Enum.TextXAlignment.Left
MsgLabel.Parent = SupportContainer

local MsgInput = Instance.new("TextBox")
MsgInput.Size = UDim2.new(1, -40, 0, 220)
MsgInput.Position = UDim2.new(0, 20, 0, 195)
MsgInput.PlaceholderText = "Type your message... (Shift+Enter to send)"
MsgInput.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MsgInput.TextColor3 = Color3.new(1,1,1)
MsgInput.Font = Enum.Font.Gotham
MsgInput.TextSize = 16
MsgInput.MultiLine = true
MsgInput.TextWrapped = true
MsgInput.ClearTextOnFocus = false
MsgInput.Parent = SupportContainer
local InputCorner = Instance.new("UICorner")
InputCorner.CornerRadius = UDim.new(0, 14)
InputCorner.Parent = MsgInput

-- NOTIFY
local Notify = Instance.new("TextLabel")
Notify.Size = UDim2.new(0, 300, 0, 60)
Notify.Position = UDim2.new(0.5, -150, 1, 20)
Notify.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
Notify.Text = ""
Notify.TextColor3 = Color3.new(1,1,1)
Notify.Font = Enum.Font.GothamBold
Notify.TextSize = 18
Notify.Visible = false
Notify.Parent = SupportContainer
local NotifyCorner = Instance.new("UICorner")
NotifyCorner.CornerRadius = UDim.new(0, 12)
NotifyCorner.Parent = Notify

-- SEND BUTTON
local SendBtn = Instance.new("TextButton")
SendBtn.Size = UDim2.new(0, 130, 0, 50)
SendBtn.BackgroundColor3 = Color3.fromRGB(88, 166, 255)
SendBtn.Text = ""
SendBtn.Parent = SupportContainer
local SendCorner = Instance.new("UICorner")
SendCorner.CornerRadius = UDim.new(0, 14)
SendCorner.Parent = SendBtn
local SendIcon = Instance.new("ImageLabel")
SendIcon.Size = UDim2.new(0, 30, 0, 30)
SendIcon.Position = UDim2.new(0, 18, 0.5, -15)
SendIcon.BackgroundTransparency = 1
SendIcon.Image = "rbxassetid://6031094678"
SendIcon.Parent = SendBtn
local SendText = Instance.new("TextLabel")
SendText.Size = UDim2.new(1, -55, 1, 0)
SendText.Position = UDim2.new(0, 55, 0, 0)
SendText.BackgroundTransparency = 1
SendText.Text = "SEND"
SendText.TextColor3 = Color3.new(1,1,1)
SendText.Font = Enum.Font.GothamBold
SendText.TextSize = 16
SendText.Parent = SendBtn
addHover(SendBtn)

-- JOIN DISCORD
local JoinBtn = Instance.new("TextButton")
JoinBtn.Size = UDim2.new(0, 160, 0, 50)
JoinBtn.BackgroundColor3 = Color3.fromRGB(114, 137, 218)
JoinBtn.Text = ""
JoinBtn.Parent = SupportContainer
local JoinCorner = Instance.new("UICorner")
JoinCorner.CornerRadius = UDim.new(0, 14)
JoinCorner.Parent = JoinBtn
local DiscordIcon = Instance.new("ImageLabel")
DiscordIcon.Size = UDim2.new(0, 30, 0, 30)
DiscordIcon.Position = UDim2.new(0, 18, 0.5, -15)
DiscordIcon.BackgroundTransparency = 1
DiscordIcon.Image = "rbxassetid://6031094678"
DiscordIcon.Parent = JoinBtn
local JoinText = Instance.new("TextLabel")
JoinText.Size = UDim2.new(1, -55, 1, 0)
JoinText.Position = UDim2.new(0, 55, 0, 0)
JoinText.BackgroundTransparency = 1
JoinText.Text = "COPY DISCORD LINK"
JoinText.TextColor3 = Color3.new(1,1,1)
JoinText.Font = Enum.Font.GothamBold
JoinText.TextSize = 10
JoinText.Parent = JoinBtn
addHover(JoinBtn)

-- KOPIOWANIE
JoinBtn.MouseButton1Click:Connect(function()
    setclipboard(DISCORD_INVITE)
    Notify.Text = "Link copied!"
    Notify.BackgroundColor3 = Color3.fromRGB(114, 137, 218)
    Notify.Visible = true
    Notify.BackgroundTransparency = 1
    TS:Create(Notify, TweenInfo.new(0.3), {BackgroundTransparency = 0, Position = UDim2.new(0.5, -150, 1, -80)}):Play()
    task.delay(2, function()
        TS:Create(Notify, TweenInfo.new(0.4), {BackgroundTransparency = 1, Position = UDim2.new(0.5, -150, 1, 20)}):Play()
        task.delay(0.4, function() Notify.Visible = false end)
    end)
end)

-- POZYCJONOWANIE PRZYCISKÓW
local function updateButtons()
    if not SupportContainer.Visible then return end
    local inputBottom = MsgInput.AbsolutePosition.Y + MsgInput.AbsoluteSize.Y + 25
    local totalWidth = 130 + 160 + 15
    local startX = (SupportContainer.AbsoluteSize.X - totalWidth) / 2
    JoinBtn.Position = UDim2.new(0, startX, 0, inputBottom - SupportContainer.AbsolutePosition.Y)
    SendBtn.Position = UDim2.new(0, startX + 160 + 15, 0, inputBottom - SupportContainer.AbsolutePosition.Y)
end
task.spawn(function()
    repeat task.wait() until SupportContainer.AbsoluteSize.X > 0
    updateButtons()
end)
MsgInput:GetPropertyChangedSignal("Text"):Connect(updateButtons)
RS.Heartbeat:Connect(updateButtons)

-- TAB SWITCH
local function switchTab(tab)
    ScriptsContainer.Visible = (tab == "scripts")
    SupportContainer.Visible = (tab == "support")
    ScriptsTab.TextColor3 = (tab == "scripts") and Color3.new(1,1,1) or Color3.fromRGB(220,220,220)
    SupportTab.TextColor3 = (tab == "support") and Color3.new(1,1,1) or Color3.fromRGB(220,220,220)
    if tab == "support" then updateButtons() end
end
ScriptsTab.MouseButton1Click:Connect(function() switchTab("scripts") end)
SupportTab.MouseButton1Click:Connect(function() switchTab("support") end)
switchTab("scripts")

-- SEND MESSAGE
local COOLDOWN_TIME = 60
local lastSendTime = 0
local cooldownActive = false
local function updateCooldown()
    if cooldownActive then
        local left = math.max(0, COOLDOWN_TIME - (tick() - lastSendTime))
        SendBtn.BackgroundColor3 = left > 0 and Color3.fromRGB(90,90,90) or Color3.fromRGB(88,166,255)
        SendText.Text = left > 0 and ("WAIT %ds"):format(math.ceil(left)) or "SEND"
    end
end
RS.Heartbeat:Connect(updateCooldown)

local function sendMessage()
    if cooldownActive then return end
    local msg = MsgInput.Text:gsub("^%s*(.-)%s*$", "%1")
    if msg == "" then return end
    cooldownActive = true
    lastSendTime = tick()
    local payload = HttpService:JSONEncode({content = ("**%s** (ID: %d) [%s]\n%s"):format(LocalPlayer.Name, LocalPlayer.UserId, _G.NZB_IS_PREMIUM and "PREMIUM" or "USER", msg)})
    local success, res = pcall(request_func, {Url = DISCORD_WEBHOOK, Method = "POST", Headers = {["Content-Type"] = "application/json"}, Body = payload})
    local ok = success and res and res.Success
    Notify.Text = ok and "Sent!" or "Error!"
    Notify.BackgroundColor3 = ok and Color3.fromRGB(40,167,69) or Color3.fromRGB(220,53,69)
    Notify.Visible = true
    Notify.BackgroundTransparency = 1
    TS:Create(Notify, TweenInfo.new(0.3), {BackgroundTransparency = 0, Position = UDim2.new(0.5,-150,1,-80)}):Play()
    task.delay(3, function()
        TS:Create(Notify, TweenInfo.new(0.4), {BackgroundTransparency = 1, Position = UDim2.new(0.5,-150,1,20)}):Play()
        task.delay(0.4, function() Notify.Visible = false end)
    end)
    MsgInput.Text = ""
end
SendBtn.MouseButton1Click:Connect(sendMessage)
MsgInput.InputBegan:Connect(function(i)
    if i.KeyCode == Enum.KeyCode.Return and UIS:IsKeyDown(Enum.KeyCode.LeftShift) then
        sendMessage()
    end
end)

-- SCRIPTS LIST
local UiLib = {}
local scriptList = {}
function UiLib:AddScript(name, desc, loadstr, status)
    table.insert(scriptList, {name = name, desc = desc, loadstring = loadstr, status = status or ""})
end
for _, s in ipairs(scripts) do
    UiLib:AddScript(s.name, s.desc, s.loadstring, s.status)
end

local function refreshScripts()
    for _, v in pairs(ScrollList:GetChildren()) do if v:IsA("Frame") then v:Destroy() end end
    local query = SearchBox.Text:lower()
    local y = 0
    for _, s in ipairs(scriptList) do
        if query == "" or s.name:lower():find(query) then
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(1, -10, 0, 85)
            frame.BackgroundColor3 = Color3.fromRGB(32, 32, 32)
            frame.Parent = ScrollList
            local c = Instance.new("UICorner")
            c.CornerRadius = UDim.new(0, 10)
            c.Parent = frame
            local name = Instance.new("TextLabel")
            name.Size = UDim2.new(1, -20, 0, 28)
            name.Position = UDim2.new(0, 12, 0, 8)
            name.BackgroundTransparency = 1
            name.Text = s.name
            name.TextColor3 = Color3.new(1,1,1)
            name.Font = Enum.Font.GothamBold
            name.TextSize = 17
            name.TextXAlignment = Enum.TextXAlignment.Left
            name.Parent = frame
            local desc = Instance.new("TextLabel")
            desc.Size = UDim2.new(1, -20, 0, 22)
            desc.Position = UDim2.new(0, 12, 0, 36)
            desc.BackgroundTransparency = 1
            desc.Text = s.desc
            desc.TextColor3 = Color3.fromRGB(180,180,180)
            desc.Font = Enum.Font.Gotham
            desc.TextSize = 13
            desc.TextXAlignment = Enum.TextXAlignment.Left
            desc.TextWrapped = true
            desc.Parent = frame
            local statusColor = s.status == "Universal" and Color3.fromRGB(255,255,0) or (s.status == "South bronx" and Color3.fromRGB(148,0,211) or Color3.fromRGB(150,150,150))
            local statusBg = Instance.new("Frame")
            statusBg.Size = UDim2.new(0, 90, 0, 20)
            statusBg.BackgroundColor3 = Color3.fromRGB(40,40,40)
            statusBg.Position = UDim2.new(0.5, -45, 0, 60)
            statusBg.Parent = frame
            local statusCorner = Instance.new("UICorner")
            statusCorner.CornerRadius = UDim.new(0, 6)
            statusCorner.Parent = statusBg
            local statusLabel = Instance.new("TextLabel")
            statusLabel.Size = UDim2.new(1, 0, 1, 0)
            statusLabel.BackgroundTransparency = 1
            statusLabel.Text = s.status
            statusLabel.TextColor3 = statusColor
            statusLabel.Font = Enum.Font.GothamBold
            statusLabel.TextSize = 12
            statusLabel.Parent = statusBg
            local runBtn = Instance.new("TextButton")
            runBtn.Size = UDim2.new(0, 85, 0, 35)
            runBtn.Position = UDim2.new(1, -97, 0.5, -17.5)
            runBtn.BackgroundColor3 = Color3.fromRGB(40, 167, 69)
            runBtn.Text = "RUN"
            runBtn.TextColor3 = Color3.new(1,1,1)
            runBtn.Font = Enum.Font.GothamBold
            runBtn.TextSize = 15
            runBtn.Parent = frame
            local rc = Instance.new("UICorner")
            rc.CornerRadius = UDim.new(0, 8)
            rc.Parent = runBtn
            addHover(runBtn)
            runBtn.MouseButton1Click:Connect(function()
                pcall(loadstring(s.loadstring))
            end)
            y = y + 95
        end
    end
    ScrollList.CanvasSize = UDim2.new(0, 0, 0, y)
end
SearchBox:GetPropertyChangedSignal("Text"):Connect(refreshScripts)
refreshScripts()

print("NZB HUB ZAŁADOWANY – PREMIUM: " .. tostring(_G.NZB_IS_PREMIUM) .. " | SCRIPTS: " .. #scripts)
